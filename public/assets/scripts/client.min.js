!function(){"use strict";angular.module("exportsNavigator",["ngMaterial","ngMessages","firebase","ngRoute"])}(),function(){"use strict";var config={apiKey:"AIzaSyCEH70PEdLMF9KAuPecpohwOr0t6VQuubU",authDomain:"exports-navigator.firebaseapp.com",databaseURL:"https://exports-navigator.firebaseio.com",storageBucket:"exports-navigator.appspot.com"};firebase.initializeApp(config)}(),function(){"use strict";function AdminAccountController(currentAuth,Data,$mdDialog){var vm=this;vm.auth=currentAuth,vm.newDisplayName="",vm.newEmail="",vm.newPassword="",vm.print=function(){Data.printPage()},vm.showSignInModal=function(ev){Data.showToast("Please sign in again to change your account."),$mdDialog.show({controller:"AuthCtrl as auth",templateUrl:"templates/auth.html",parent:angular.element(document.body),targetEvent:ev,clickOutsideToClose:!0,fullscreen:!0}).then(function(){vm.newDisplayName.length>0&&Data.updateDisplayName(vm.newDisplayName),vm.newEmail.length>0&&Data.updateUserEmail(vm.newEmail),vm.newPassword.length>0&&Data.updateUserPassword(vm.newPassword),0===vm.newDisplayName.length&&0===vm.newEmail.length&&0===vm.newPassword.length&&Data.showToast("Sorry, you haven't entered any changes to your account info. Please try again.")},function(){})}}angular.module("exportsNavigator").controller("AdminAccountController",AdminAccountController),AdminAccountController.$inject=["currentAuth","Data","$mdDialog"]}(),function(){"use strict";function AdminContactsAddController(currentAuth,$http,Data){var vm=this;vm.newContact={first_name:"",last_name:"",title:"",organization:"",email:"",phone:""},vm.saveContact=function(){Data.createContact(vm.newContact)}}angular.module("exportsNavigator").controller("AdminContactsAddController",AdminContactsAddController),AdminContactsAddController.$inject=["currentAuth","$http","Data"]}(),function(){"use strict";function AdminContactsController(currentAuth,Data){var vm=this;vm.data=Data.data;for(var i=0;vm.data.contacts.length>i;i++)vm.data.contacts[i].full_name=vm.data.contacts[i].first_name+" "+vm.data.contacts[i].last_name;vm.print=function(){Data.printPage()}}angular.module("exportsNavigator").controller("AdminContactsController",AdminContactsController),AdminContactsController.$inject=["currentAuth","Data"]}(),function(){"use strict";function AdminContactsEditController(currentAuth,$http,$routeParams,$location,Data){function findRecordIndex(recordID){for(var i=0;vm.data.contacts.length>i;i++)if(recordID===vm.data.contacts[i].id){vm.selectedRecordIndex=i;break}}var vm=this;vm.data=Data.data,vm.selectedContact=parseInt($routeParams.contactID),findRecordIndex(vm.selectedContact),vm.update=function(){var updatedContact={id:vm.selectedContact,first_name:vm.data.contacts[vm.selectedRecordIndex].first_name,last_name:vm.data.contacts[vm.selectedRecordIndex].last_name,title:vm.data.contacts[vm.selectedRecordIndex].title,organization:vm.data.contacts[vm.selectedRecordIndex].organization,email:vm.data.contacts[vm.selectedRecordIndex].email,phone:vm.data.contacts[vm.selectedRecordIndex].phone};Data.updateContact(updatedContact)},vm.delete=function(recordID){Data.deleteContact(recordID)}}angular.module("exportsNavigator").controller("AdminContactsEditController",AdminContactsEditController),AdminContactsEditController.$inject=["currentAuth","$http","$routeParams","$location","Data"]}(),function(){"use strict";function AdminCountriesAddController(currentAuth,$http,Data){var vm=this;vm.data=Data.data,Data.getContacts(),vm.newCountry={},vm.saveCountry=function(){Data.createCountry(vm.newCountry)}}angular.module("exportsNavigator").controller("AdminCountriesAddController",AdminCountriesAddController),AdminCountriesAddController.$inject=["currentAuth","$http","Data"]}(),function(){"use strict";function AdminCountriesController(currentAuth,Data,$log,$timeout,$q){var vm=this;vm.data=Data.data,Data.getCountries().then(function(countries){vm.countries=countries}),vm.print=function(){Data.printPage()}}angular.module("exportsNavigator").controller("AdminCountriesController",AdminCountriesController),AdminCountriesController.$inject=["currentAuth","Data","$log","$timeout","$q"]}(),function(){"use strict";function AdminCountriesEditController(currentAuth,$http,$routeParams,$location,Data){function findRecordIndex(recordID){for(var i=0;vm.data.countries.length>i;i++)if(recordID===vm.data.countries[i].id){vm.selectedRecordIndex=i;break}}var vm=this;vm.data=Data.data,vm.selectedCountry=parseInt($routeParams.countryID),findRecordIndex(vm.selectedCountry),vm.update=function(){var updatedCountry={id:vm.selectedCountry,country:vm.data.countries[vm.selectedRecordIndex].country,note:vm.data.countries[vm.selectedRecordIndex].note,contact_id:vm.data.countries[vm.selectedRecordIndex].contact_id};Data.updateCountry(updatedCountry)},vm.delete=function(recordID){Data.deleteCountry(recordID)}}angular.module("exportsNavigator").controller("AdminCountriesEditController",AdminCountriesEditController),AdminCountriesEditController.$inject=["currentAuth","$http","$routeParams","$location","Data"]}(),function(){"use strict";function AdminHomeController(currentAuth,$location,$timeout,Auth){function createGreeting(user){user.displayName?vm.greetingName=user.displayName:vm.greetingName="User"}var vm=this;vm.auth=Auth,vm.goToPath=function(path){$timeout(function(){$location.path(path)},250)},vm.userQueriesFail="(number goes here)",vm.dataTiles=[{path:"/admin/reports",name:"Queries With No Results",icon:"error_outline"}],vm.taskTiles=[{path:"/admin/industries",name:"Industries",icon:"business"},{path:"/admin/topics",name:"Topics",icon:"chat_bubble"},{path:"/admin/countries",name:"Countries",icon:"public"},{path:"/admin/contacts",name:"Contacts",icon:"contacts"},{path:"/admin/websites",name:"Websites",icon:"web"},{path:"/admin/reports",name:"Reports",icon:"show_chart"},{path:"/admin/account",name:"Account",icon:"supervisor_account"}],vm.auth.$onAuthStateChanged(function(user){createGreeting(user)})}angular.module("exportsNavigator").controller("AdminHomeController",AdminHomeController),AdminHomeController.$inject=["currentAuth","$location","$timeout","Auth"]}(),function(){"use strict";function AdminIndustriesAddController(currentAuth,Data){var vm=this;vm.data=Data.data,vm.add=function(){var newContact1=null,newContact2=null,newContact3=null,newWebsite1=null,newWebsite2=null,newWebsite3=null;void 0!==vm.newContact_1&&(newContact1=parseInt(vm.newContact_1.id)),void 0!==vm.newContact_2&&(newContact2=parseInt(vm.newContact_2.id)),void 0!==vm.newContact_3&&(newContact3=parseInt(vm.newContact_3.id)),void 0!==vm.newWebsite_1&&(newWebsite1=parseInt(vm.newWebsite_1.id)),void 0!==vm.newWebsite_2&&(newWebsite2=parseInt(vm.newWebsite_2.id)),void 0!==vm.newWebsite_3&&(newWebsite3=parseInt(vm.newWebsite_3.id));var newIndustry={industry:vm.newIndustry,note_1:vm.newNote_1,note_2:vm.newNote_2,note_3:vm.newNote_3,contact_1:newContact1,contact_2:newContact2,contact_3:newContact3,website_1:newWebsite1,website_2:newWebsite2,website_3:newWebsite3};Data.createIndustry(newIndustry)}}angular.module("exportsNavigator").controller("AdminIndustriesAddController",AdminIndustriesAddController),AdminIndustriesAddController.$inject=["currentAuth","Data"]}(),function(){"use strict";function AdminIndustriesController(currentAuth,$http,Data){var vm=this;vm.data=Data.data,Data.getIndustries(),vm.add=function(){console.log("Add clicked")},vm.edit=function(){console.log("Edit clicked")},vm.print=function(){Data.printPage()}}angular.module("exportsNavigator").controller("AdminIndustriesController",AdminIndustriesController),AdminIndustriesController.$inject=["currentAuth","$http","Data"]}(),function(){"use strict";function AdminIndustriesEditController(currentAuth,$http,$routeParams,Data,$location){function findRecordIndex(recordID){for(var i=0;vm.data.industries.length>i;i++)if(recordID===vm.data.industries[i].id){vm.selectedRecordIndex=i;break}}var vm=this;vm.data=Data.data,vm.selectedIndustry=parseInt($routeParams.itemID),findRecordIndex(vm.selectedIndustry),console.log("vm.data",vm.data),console.log("vm.data.industries[1]",vm.data.industries[1]),vm.update=function(){var contact1,contact2,contact3;contact1=null!==vm.data.industries[vm.selectedRecordIndex].contact_id_1?vm.data.industries[vm.selectedRecordIndex].contact_id_1:null,contact2=null!==vm.data.industries[vm.selectedRecordIndex].contact_id_2?vm.data.industries[vm.selectedRecordIndex].contact_id_2:null,contact3=null!==vm.data.industries[vm.selectedRecordIndex].contact_id_3?vm.data.industries[vm.selectedRecordIndex].contact_id_3:null;var update={id:vm.selectedIndustry,industry:vm.data.industries[vm.selectedRecordIndex].industry,note_1:vm.data.industries[vm.selectedRecordIndex].note_1,note_2:vm.data.industries[vm.selectedRecordIndex].note_2,note_3:vm.data.industries[vm.selectedRecordIndex].note_3,contact_1:contact1,contact_2:contact2,contact_3:contact3,website_1:vm.data.industries[vm.selectedRecordIndex].website_id_1,website_2:vm.data.industries[vm.selectedRecordIndex].website_id_2,website_3:vm.data.industries[vm.selectedRecordIndex].website_id_3};Data.updateIndustry(update)},vm.delete=function(itemID){confirm("Are you sure you want to delete this topic?")&&Data.deleteIndustry(itemID)}}angular.module("exportsNavigator").controller("AdminIndustriesEditController",AdminIndustriesEditController),AdminIndustriesEditController.$inject=["currentAuth","$http","$routeParams","Data","$location"]}(),function(){"use strict";function AdminReportsController(currentAuth,$http,Data){var vm=this;vm.getUserData=function(){$http.get("/db/topics/number_of_hits").then(function(response){return console.log("getting topics data",response),vm.topicsList=response.data.rows,vm.topicsList},function(response){console.log("error getting topics data",response)})},vm.getUserData();vm.getUnmatched=function(){$http.get("/db/unmatched").then(function(response){return console.log("getting unmatched topics ",response),vm.unmatchedList=response.data.rows,vm.unmatchedList},function(response){console.log("error getting unmatched topics",response)})},vm.getUnmatched(),vm.print=function(){Data.printPage()}}angular.module("exportsNavigator").controller("AdminReportsController",AdminReportsController),AdminReportsController.$inject=["currentAuth","$http","Data"]}(),function(){"use strict";function AdminTopicsAddController(currentAuth,Data){var vm=this;vm.data=Data.data,Data.getContacts(),Data.getWebsites(),vm.add=function(){var newContact1=null,newContact2=null,newContact3=null,newWebsite1=null,newWebsite2=null,newWebsite3=null;void 0!==vm.newContact_1&&(newContact1=parseInt(vm.newContact_1.id)),void 0!==vm.newContact_2&&(newContact2=parseInt(vm.newContact_2.id)),void 0!==vm.newContact_3&&(newContact3=parseInt(vm.newContact_3.id)),void 0!==vm.newWebsite_1&&(newWebsite1=parseInt(vm.newWebsite_1.id)),void 0!==vm.newWebsite_2&&(newWebsite2=parseInt(vm.newWebsite_2.id)),void 0!==vm.newWebsite_3&&(newWebsite3=parseInt(vm.newWebsite_3.id));var newTopic={topic:vm.newTopic,note_1:vm.newNote_1,note_2:vm.newNote_2,note_3:vm.newNote_3,contact_1:newContact1,contact_2:newContact2,contact_3:newContact3,website_1:newWebsite1,website_2:newWebsite2,website_3:newWebsite3};console.log("newTopic: ",newTopic),console.log("vm.newWebsite_1: ",vm.newWebsite_1),Data.createTopic(newTopic)}}angular.module("exportsNavigator").controller("AdminTopicsAddController",AdminTopicsAddController),AdminTopicsAddController.$inject=["currentAuth","Data"]}(),function(){"use strict";function AdminTopicsController(currentAuth,$http,Data){var vm=this;vm.data=Data.data,Data.getTopics(),vm.export=function(){console.log("Export clicked")},vm.import=function(){console.log("Import clicked")},vm.print=function(){Data.printPage()}}angular.module("exportsNavigator").controller("AdminTopicsController",AdminTopicsController),AdminTopicsController.$inject=["currentAuth","$http","Data"]}(),function(){"use strict";function AdminTopicsEditController(currentAuth,$http,$routeParams,Data,$location){function findRecordIndex(recordID){for(var i=0;vm.data.topics.length>i;i++)if(recordID===vm.data.topics[i].id){vm.selected=i;break}}var vm=this;vm.data=Data.data,vm.topicId=parseInt($routeParams.itemID),findRecordIndex(vm.topicId),console.log("vm.data",vm.data),console.log("vm.data.contacts",vm.data.contacts),vm.update=function(){var contact1,contact2,contact3;contact1=null!==vm.data.topics[vm.selected].contact_id_1?vm.data.topics[vm.selected].contact_id_1:null,contact2=null!==vm.data.topics[vm.selected].contact_id_2?vm.data.topics[vm.selected].contact_id_2:null,contact3=null!==vm.data.topics[vm.selected].contact_id_3?vm.data.topics[vm.selected].contact_id_3:null;var update={id:vm.data.topics[vm.selected].id,topic:vm.data.topics[vm.selected].topic,note_1:vm.data.topics[vm.selected].note_1,note_2:vm.data.topics[vm.selected].note_2,note_3:vm.data.topics[vm.selected].note_3,contact_1:contact1,contact_2:contact2,contact_3:contact3,website_1:vm.data.topics[vm.selected].website_id_1,website_2:vm.data.topics[vm.selected].website_id_2,website_3:vm.data.topics[vm.selected].website_id_3};Data.updateTopic(update).then(function(response){console.log("response",response)},function(err){console.log("err:",err)})},vm.delete=function(){var id=vm.data.topics[vm.selected].id;console.log("vm.data.topics[vm.selected].id:",id),confirm("Are you sure you want to delete this topic?")&&(Data.deleteTopic(id),$location.url("/admin/topics"))}}angular.module("exportsNavigator").controller("AdminTopicsEditController",AdminTopicsEditController),AdminTopicsEditController.$inject=["currentAuth","$http","$routeParams","Data","$location"]}(),function(){"use strict";function AdminWebsitesAddController(currentAuth,Data){var vm=this;vm.data=Data.data,vm.add=function(){var newWebsite={website:vm.newWebsite};Data.createWebsite(newWebsite)}}angular.module("exportsNavigator").controller("AdminWebsitesAddController",AdminWebsitesAddController),AdminWebsitesAddController.$inject=["currentAuth","Data"]}(),function(){"use strict";function AdminWebsitesController(currentAuth,Data){var vm=this;vm.data=Data.data,Data.getWebsites(),vm.print=function(){Data.printPage()}}angular.module("exportsNavigator").controller("AdminWebsitesController",AdminWebsitesController),AdminWebsitesController.$inject=["currentAuth","Data"]}(),function(){"use strict";function AdminWebsitesEditController(currentAuth,$http,$routeParams,$location,Data){function findRecordIndex(recordID){for(var i=0;vm.data.websites.length>i;i++)if(recordID===vm.data.websites[i].id){vm.selectedRecordIndex=i;break}}var vm=this;vm.data=Data.data,vm.selectedWebsite=parseInt($routeParams.websiteID),findRecordIndex(vm.selectedWebsite),vm.update=function(){var updatedWebsite={id:vm.selectedWebsite,website:vm.data.websites[vm.selectedRecordIndex].website};Data.updateWebsite(updatedWebsite)},vm.delete=function(recordID){Data.deleteWebsite(recordID)}}angular.module("exportsNavigator").controller("AdminWebsitesEditController",AdminWebsitesEditController),AdminWebsitesEditController.$inject=["currentAuth","$http","$routeParams","$location","Data"]}(),function(){"use strict";function Auth($firebaseAuth){return $firebaseAuth()}angular.module("exportsNavigator").factory("Auth",["$firebaseAuth",Auth])}(),function(){"use strict";function AuthCtrl(Auth,$location,$mdDialog,Data){var vm=this;Auth.$onAuthStateChanged(function(firebaseUser){firebaseUser&&$location.path("/admin")}),vm.signIn=function(){Auth.$signInWithEmailAndPassword(vm.user.email,vm.user.password).then(function(firebaseUser){Data.showToast("Signed in successfully!"),$location.path("/admin"),$mdDialog.hide()}).catch(function(error){Data.showToast("Please try again. "+error)})},vm.sendPasswordResetEmail=function(){Data.sendPasswordResetEmail(vm.user.email)},vm.hide=function(){$mdDialog.hide()},vm.cancel=function(){$mdDialog.cancel()},vm.answer=function(answer){$mdDialog.hide(answer)}}angular.module("exportsNavigator").controller("AuthCtrl",AuthCtrl),AuthCtrl.$inject=["Auth","$location","$mdDialog","Data"]}(),function(){"use strict";function redirectHome($rootScope,$location,$http,Auth){$rootScope.$on("$routeChangeError",function(event,next,previous,error){"AUTH_REQUIRED"===error&&$location.path("/")}),Auth.$onAuthStateChanged(function(user){user?user.getToken(!0).then(function(idToken){$http.defaults.headers.common.firebaseToken=idToken}).catch(function(error){console.log("firebaseToken authentication header was not set correctly.")}):$http.defaults.headers.common.firebaseToken=null})}angular.module("exportsNavigator").run(["$rootScope","$location","$http","Auth",redirectHome])}(),function(){"use strict";function configRouteTheme($routeProvider,$locationProvider,$mdThemingProvider){$routeProvider.when("/",{controller:"HomeCtrl as home",templateUrl:"views/home.html"}).when("/results/:industry/:topic?",{controller:"ResultsCtrl as results",templateUrl:"views/results.html"}).when("/admin",{controller:"AdminHomeController as adminHome",templateUrl:"views/adminHome.html",resolve:{currentAuth:["Auth",function(Auth){return Auth.$requireSignIn()}]}}).when("/admin/industries",{controller:"AdminIndustriesController as adminIndustries",templateUrl:"views/adminIndustries.html",resolve:{currentAuth:["Auth",function(Auth){return Auth.$requireSignIn()}]}}).when("/admin/industries/add",{controller:"AdminIndustriesAddController as adminIndustriesAdd",templateUrl:"views/adminIndustriesAdd.html",resolve:{currentAuth:["Auth",function(Auth){return Auth.$requireSignIn()}],data:["Data",function(Data){return Promise.all([Data.getWebsites(),Data.getContacts(),Data.getIndustries()])}]}}).when("/admin/industries/:itemID",{controller:"AdminIndustriesEditController as adminIndustriesEdit",templateUrl:"views/adminIndustriesEdit.html",resolve:{currentAuth:["Auth",function(Auth){return Auth.$requireSignIn()}],data:["Data",function(Data){return Promise.all([Data.getWebsites(),Data.getContacts(),Data.getIndustries()])}]}}).when("/admin/topics",{controller:"AdminTopicsController as adminTopics",templateUrl:"views/adminTopics.html",resolve:{currentAuth:["Auth",function(Auth){return Auth.$requireSignIn()}]}}).when("/admin/topics/add",{controller:"AdminTopicsAddController as adminTopicsAdd",templateUrl:"views/adminTopicsAdd.html",resolve:{currentAuth:["Auth",function(Auth){return Auth.$requireSignIn()}],data:["Data",function(Data){return Promise.all([Data.getWebsites(),Data.getContacts(),Data.getTopics()])}]}}).when("/admin/topics/:itemID",{controller:"AdminTopicsEditController as adminTopicsEdit",templateUrl:"views/adminTopicsEdit.html",resolve:{currentAuth:["Auth",function(Auth){return Auth.$requireSignIn()}],data:["Data",function(Data){return Promise.all([Data.getTopics(),Data.getContacts(),Data.getWebsites()])}]}}).when("/admin/countries",{controller:"AdminCountriesController as adminCountries",templateUrl:"views/adminCountries.html",resolve:{currentAuth:["Auth",function(Auth){return Auth.$requireSignIn()}]}}).when("/admin/countries/add",{controller:"AdminCountriesAddController as adminCountriesAdd",templateUrl:"views/adminCountriesAdd.html",resolve:{currentAuth:["Auth",function(Auth){return Auth.$requireSignIn()}],data:["Data",function(Data){return Promise.all([Data.getContacts()])}]}}).when("/admin/countries/:countryID",{controller:"AdminCountriesEditController as adminCountriesEdit",templateUrl:"views/adminCountriesEdit.html",resolve:{currentAuth:["Auth",function(Auth){return Auth.$requireSignIn()}],data:["Data",function(Data){return Promise.all([Data.getContacts(),Data.getCountries()])}]}}).when("/admin/contacts",{controller:"AdminContactsController as adminContacts",templateUrl:"views/adminContacts.html",resolve:{currentAuth:["Auth",function(Auth){return Auth.$requireSignIn()}],data:["Data",function(Data){return Promise.all([Data.getContacts()])}]}}).when("/admin/contacts/add",{controller:"AdminContactsAddController as adminContactsAdd",templateUrl:"views/adminContactsAdd.html",resolve:{currentAuth:["Auth",function(Auth){return Auth.$requireSignIn()}]}}).when("/admin/contacts/:contactID",{controller:"AdminContactsEditController as adminContactsEdit",templateUrl:"views/adminContactsEdit.html",resolve:{currentAuth:["Auth",function(Auth){return Auth.$requireSignIn()}],data:["Data",function(Data){return Promise.all([Data.getContacts()])}]}}).when("/admin/websites",{controller:"AdminWebsitesController as adminWebsites",templateUrl:"views/adminWebsites.html",resolve:{currentAuth:["Auth",function(Auth){return Auth.$requireSignIn()}]}}).when("/admin/websites/add",{controller:"AdminWebsitesAddController as adminWebsitesAdd",templateUrl:"views/adminWebsitesAdd.html",resolve:{currentAuth:["Auth",function(Auth){return Auth.$requireSignIn()}]}}).when("/admin/websites/:websiteID",{controller:"AdminWebsitesEditController as adminWebsitesEdit",templateUrl:"views/adminWebsitesEdit.html",resolve:{currentAuth:["Auth",function(Auth){return Auth.$requireSignIn()}],data:["Data",function(Data){return Promise.all([Data.getWebsites()])}]}}).when("/admin/reports",{controller:"AdminReportsController as adminReports",templateUrl:"views/adminReports.html",resolve:{currentAuth:["Auth",function(Auth){return Auth.$requireSignIn()}]}}).when("/admin/account",{controller:"AdminAccountController as adminAccount",templateUrl:"views/adminAccount.html",resolve:{currentAuth:["Auth",function(Auth){return Auth.$requireSignIn()}]}}).otherwise({controller:"HomeCtrl as home",templateUrl:"views/home.html"}),$locationProvider.html5Mode(!0),$mdThemingProvider.definePalette("GreaterMSPColors",{50:"89ccda",100:"d0d741",200:"3a3431",300:"b7be16",400:"ece8b2",500:"4fbbd1",600:"f5d258",700:"98579b",800:"e58426",900:"cc6ca6",A100:"006da3",A200:"b4981d",A400:"db3762",A700:"006da3",contrastDefaultColor:"light",contrastDarkColors:["400"],contrastLightColors:void 0}),$mdThemingProvider.theme("default").primaryPalette("GreaterMSPColors",{default:"50","hue-1":"100","hue-2":"200"}).accentPalette("GreaterMSPColors",{default:"300","hue-1":"500"}).warnPalette("GreaterMSPColors",{default:"600","hue-1":"800","hue-2":"A400"}).backgroundPalette("grey")}angular.module("exportsNavigator").config(["$routeProvider","$locationProvider","$mdThemingProvider",configRouteTheme])}(),function(){"use strict";function Data($http,Auth,$mdToast){var data={},showToast=function(message){$mdToast.show($mdToast.simple().textContent(message).position("top right").hideDelay(3e3))},printPage=function(){showToast("Launching your system's print dialog!"),window.print()},getIndustries=function(){return $http.get("/db/industries").then(function(response){data.industries=response.data.rows}).catch(function(error){console.error("Error:",error)})},getTopics=function(){return $http.get("/db/topics").then(function(response){data.topics=response.data.rows}).catch(function(error){console.error("Error:",error)})},getCountries=function(){return $http.get("/db/countries").then(function(response){data.countries=response.data.rows}).catch(function(error){console.error("Error:",error)})},getContacts=function(){return $http.get("/db/contacts").then(function(response){data.contacts=response.data.rows}).catch(function(error){console.error("Error:",error)})},getWebsites=function(){return $http.get("/db/websites").then(function(response){data.websites=response.data.rows}).catch(function(error){console.error("Error:",error)})},getUnmatched=function(){return $http.get("/db/unmatched").then(function(response){data.unmatched=response.data.rows}).catch(function(error){console.error("Error:",error)})},getTopicsNumberOfHits=function(){return $http.get("/db/topics/number_of_hits").then(function(response){data.topicsNumberOfHits=response.data.rows}).catch(function(error){console.error("Error:",error)})},getFailed=function(){return $http.get("/db/last_resort").then(function(response){data.failed=response.data.rows}).catch(function(error){console.error("Error:",error)})},createContact=function(contactObject){return $http.post("/db/contacts/create",contactObject).then(function(response){console.log("Successful POST to /db/contacts/create"),getContacts(),showToast("New contact successfully added!")}).catch(function(error){console.error("Error:",error),showToast("Sorry, adding a new contact failed. Please try again.\nError: "+error)})},createCountry=function(countryObject){return $http.post("/db/countries/create",countryObject).then(function(response){console.log("Successful POST to /db/countries/create"),getCountries(),showToast("New country successfully added!")}).catch(function(error){console.error("Error:",error),showToast("Sorry, adding a new country failed. Please try again.\nError: "+error)})},createIndustry=function(industryObject){return $http.post("/db/industries/create",industryObject).then(function(response){console.log("Successful POST to /db/industries/create"),getIndustries(),showToast("New industry successfully added!")}).catch(function(error){console.error("Error:",error),showToast("Sorry, adding a new industry failed. Please try again.\nError: "+error)})},createTopic=function(topicObject){return $http.post("/db/topics/create",topicObject).then(function(response){console.log("Successful POST to /db/topics/create"),getTopics(),showToast("New topic successfully added!")}).catch(function(error){console.error("Error:",error),showToast("Sorry, adding a new topic failed. Please try again.\nError: "+error)})},createWebsite=function(websiteObject){return $http.post("/db/websites/create",websiteObject).then(function(response){console.log("Successful POST to /db/websites/create"),getWebsites(),showToast("New website successfully added!")}).catch(function(error){console.error("Error:",error),showToast("Sorry, adding a new website failed. Please try again.\nError: "+error)})},createUnmatchedTopic=function(unmatchedTopic){return $http.post("/db/unmatched/create",{unmatched_topic:unmatchedTopic}).then(function(response){console.log("Successful POST to /db/unmatched/create"),getUnmatched()}).catch(function(error){console.error("Error:",error)})},updateContact=function(contactObject){return $http.put("/db/contacts/update",contactObject).then(function(response){console.log("Successful PUT to /db/contacts/update"),getContacts(),showToast("Contact successfully updated!")}).catch(function(error){console.error("Error:",error),showToast("Sorry, updating the contact failed. Please try again.\nError: "+error)})},updateCountry=function(countryObject){return $http.put("/db/countries/update",countryObject).then(function(response){console.log("Successful PUT to /db/countries/update"),getCountries(),showToast("Country successfully updated!")}).catch(function(error){console.error("Error:",error),showToast("Sorry, updating the country failed. Please try again.\nError: "+error)})},updateIndustry=function(industryObject){return $http.put("/db/industries/update",industryObject).then(function(response){console.log("Successful PUT to /db/industries/update"),getIndustries(),showToast("Industry successfully updated!")}).catch(function(error){console.error("Error:",error),showToast("Sorry, updating the industry failed. Please try again.\nError: "+error)})},updateTopic=function(topicObject){return console.log("contactObject:",topicObject),$http.put("/db/topics/update",topicObject).then(function(response){console.log("Successful PUT to /db/topics/update"),getTopics(),showToast("Topic successfully updated!")}).catch(function(error){console.error("Error:",error),showToast("Sorry, updating the topic failed. Please try again.\nError: "+error)})},updateTopicNumberOfHits=function(topicId){return $http.put("/db/topics/update/number_of_hits",{id:topicId}).then(function(response){console.log("Successful PUT to /db/topics/update/number_of_hits"),getTopicsNumberOfHits()}).catch(function(error){console.error("Error:",error)})},updateUnmatchedTopicNumberOfHits=function(unmatchedTopicId){return $http.put("/db/topics/update/unmatched_number_of_hits",{id:unmatchedTopicId}).then(function(response){console.log("Successful PUT to /db/topics/update/unmatched_number_of_hits"),getUnmatched()}).catch(function(error){console.error("Error:",error)})},updateWebsite=function(websiteObject){return $http.put("/db/websites/update",websiteObject).then(function(response){console.log("Successful PUT to /db/websites/update"),getWebsites(),showToast("Website successfully updated!")}).catch(function(error){console.error("Error:",error),showToast("Sorry, updating the website failed. Please try again.\nError: "+error)})},deleteContact=function(contactId){return $http.delete("/db/contacts/delete/"+contactId).then(function(response){console.log("Successful DELETE to /db/contacts/delete/"+contactId),getContacts(),showToast("Contact successfully deleted!")}).catch(function(error){console.error("Error:",error),showToast("Sorry, deleting the contact failed. Please try again.\nError: "+error)})},deleteCountry=function(countryId){return $http.delete("/db/countries/delete/"+countryId).then(function(response){console.log("Successful DELETE to /db/countries/delete/"+countryId),getCountries(),showToast("Country successfully deleted!")}).catch(function(error){console.error("Error:",error),showToast("Sorry, deleting the country failed. Please try again.\nError: "+error)})},deleteIndustry=function(industryId){return $http.delete("/db/industries/delete/"+industryId).then(function(response){console.log("Successful DELETE to /db/industries/delete/"+industryId),getIndustries(),showToast("Industry successfully deleted!")}).catch(function(error){console.error("Error:",error),showToast("Sorry, deleting the industry failed. Please try again.\nError: "+error)})},deleteTopic=function(topicId){return $http.delete("/db/topics/delete/"+topicId).then(function(response){console.log("Successful DELETE to /db/topics/delete/"+topicId),getTopics(),showToast("Topic successfully deleted!")}).catch(function(error){console.error("Error:",error),showToast("Sorry, deleting the topic failed. Please try again.\nError: "+error)})},deleteWebsite=function(websiteId){return $http.delete("/db/websites/delete/"+websiteId).then(function(response){console.log("Successful DELETE to /db/websites/delete/"+websiteId),getWebsites(),showToast("Website successfully deleted!")}).catch(function(error){console.error("Error:",error),showToast("Sorry, deleting the website failed. Please try again.\nError: "+error)})},createNewUser=function(email,password){return Auth.$createUserWithEmailAndPassword(email,password).then(function(user){showToast("User "+user.uid+" created successfully!")}).catch(function(error){console.error("Error:",error),showToast("Sorry, creating a new user failed. Please try again.\nError: "+error)})},updateUserPassword=function(newPassword){return Auth.$updatePassword(newPassword).then(function(){showToast("Password changed successfully!")}).catch(function(error){console.error("Error:",error),showToast("Sorry, changing your password failed. Please try again.\nError: "+error)})},updateUserEmail=function(newEmail){return Auth.$updateEmail(newEmail).then(function(){showToast("Email changed to "+newEmail+" successfully!")}).catch(function(error){console.error("Error:",error),showToast("Sorry, changing your email address failed. Please try again.\nError: "+error)})},deleteUser=function(){return Auth.$deleteUser().then(function(){showToast("User deleted successfully!")}).catch(function(error){console.error("Error:",error),showToast("Sorry, deleting the user failed. Please try again.\nError: "+error)})},sendPasswordResetEmail=function(email){return Auth.$sendPasswordResetEmail(email).then(function(){showToast("Password reset email sent successfully!")}).catch(function(error){console.error("Error:",error),showToast("Sorry, sending the password reset email failed. Please try again.\nError: "+error)})},updateDisplayName=function(displayName){return Auth.$getAuth().updateProfile({displayName:displayName}).then(function(){showToast("Display name has been set to "+displayName+" successfully!")}).catch(function(error){
console.error("Error:",error),showToast("Sorry, updating your display name failed. Please try again.\nError: "+error)})};return{data:data,showToast:showToast,printPage:printPage,getIndustries:getIndustries,getTopics:getTopics,getCountries:getCountries,getContacts:getContacts,getWebsites:getWebsites,getUnmatched:getUnmatched,getTopicsNumberOfHits:getTopicsNumberOfHits,getFailed:getFailed,createCountry:createCountry,createTopic:createTopic,createContact:createContact,createIndustry:createIndustry,createWebsite:createWebsite,createUnmatchedTopic:createUnmatchedTopic,updateContact:updateContact,updateCountry:updateCountry,updateIndustry:updateIndustry,updateTopic:updateTopic,updateTopicNumberOfHits:updateTopicNumberOfHits,updateWebsite:updateWebsite,updateUnmatchedTopicNumberOfHits:updateUnmatchedTopicNumberOfHits,deleteContact:deleteContact,deleteCountry:deleteCountry,deleteIndustry:deleteIndustry,deleteTopic:deleteTopic,deleteWebsite:deleteWebsite,createNewUser:createNewUser,updateUserPassword:updateUserPassword,updateUserEmail:updateUserEmail,deleteUser:deleteUser,sendPasswordResetEmail:sendPasswordResetEmail,updateDisplayName:updateDisplayName}}angular.module("exportsNavigator").factory("Data",["$http","Auth","$mdToast",Data])}(),function(){"use strict";function FooterCtrl($mdDialog,Auth,$location){var vm=this;vm.auth=Auth,vm.auth.$onAuthStateChanged(function(user){vm.user=user}),vm.showSignInModal=function(ev){$mdDialog.show({controller:"AuthCtrl as auth",templateUrl:"templates/auth.html",parent:angular.element(document.body),targetEvent:ev,clickOutsideToClose:!0,fullscreen:!0}).then(function(answer){vm.status='You said the information was "'+answer+'".'},function(){vm.status="You cancelled the dialog."})}}angular.module("exportsNavigator").controller("FooterCtrl",FooterCtrl),FooterCtrl.$inject=["$mdDialog","Auth","$location"]}(),function(){"use strict";function HomeCtrl($http,Data){var vm=this;vm.data=Data.data,Data.getIndustries(),vm.selectedId=2,vm.selectedIndustry=function(industrySelected){console.log("you chose this industry:",vm.industrySelected);var thisIndustry=vm.industrySelected.industry;return thisIndustry}}angular.module("exportsNavigator").controller("HomeCtrl",HomeCtrl),HomeCtrl.$inject=["$http","Data"]}(),function(){"use strict";function ResultsCtrl($location,$routeParams,$http,Data){function checkIsOther(){7!=vm.industry?(vm.showIndustryContacts=!0,vm.showTopicSearch=!1):(vm.showIndustryContacts=!1,vm.showTopicSearch=!0)}function getCountryList(){$http.get("/db/countries").then(function(response){vm.countryList=response.data.rows},function(response){console.log("error getting country data",response.data)})}function checkTopicHasMatch(){vm.hasTopicMatch=!1,vm.noTopicMatch=!1;for(var i=0;i<vm.data.topics.length;i++)if(vm.data.topics[i].topic==vm.selectedTopic){vm.item=vm.data.topics[i];var topicId=vm.item.id;topicId=parseInt(topicId),console.log("thisTopicId:",topicId),Data.updateTopicNumberOfHits(topicId),vm.hasTopicMatch=!0,vm.noTopicMatch=!1;break}if(!vm.hasTopicMatch){vm.hasTopicMatch=!1,vm.noTopicMatch=!0,vm.noUnmatchedTopic=!0;var unmatchedTopic=vm.selectedTopic;console.log("unmatched topic:",unmatchedTopic);for(var j=0;j<vm.data.unmatched.length;j++)if(vm.data.unmatched[j].unmatched_topic==vm.selectedTopic){console.log("unmatched topic",vm.data.unmatched[j]);var unmatchedTopicId=vm.data.unmatched[j].id;unmatchedTopicId=parseInt(unmatchedTopicId),console.log("this unmatchedTopicId",unmatchedTopicId),vm.noUnmatchedTopic=!1,Data.updateUnmatchedTopicNumberOfHits(unmatchedTopicId);break}vm.noUnmatchedTopic&&Data.createUnmatchedTopic(unmatchedTopic)}}function checkCountryHasMatch(){for(var i=0;i<vm.countryList.length;i++){if(vm.countryList[i].country==vm.selectedCountry){vm.item=vm.countryList[i],vm.hasCountryMatch=!0,vm.noCountryMatch=!1,vm.showTopicSearch=!1,vm.happy=!1;break}vm.hasCountryMatch=!1,vm.noCountryMatch=!0}}var vm=this;vm.data=Data.data,vm.showIndustryContacts=!1,vm.showTopicSearch=!1,vm.noMatch=!1,vm.hasMatch=!1,vm.happy=!1,vm.unHappy=!1,vm.selectedTopic=null,vm.selectedCountry=null,vm.item=void 0,vm.failed=void 0,vm.industry=$routeParams.industry,vm.topic=$routeParams.topic,vm.industryList=vm.data.industries,vm.displaySelectedTopic=function(){vm.topicList=vm.data.topics,console.log("vm.topicList",vm.data.topics),checkTopicHasMatch()},vm.displaySelectedCountry=function(){checkCountryHasMatch()},Data.getTopics(),Data.getUnmatched(),console.log("getting unmatched topics",vm.data.unmatched),Data.getIndustries(),checkIsOther(),Data.getFailed(),getCountryList(),vm.getFailedTopicResult=function(){vm.unHappy=!0,vm.hasCountryMatch=!1,vm.noTopicMatch=!1,vm.happy=!1,console.log("failed info",vm.data.failed[0]),vm.failed=vm.data.failed[0]},vm.happyGoodbye=function(){vm.happy=!0}}angular.module("exportsNavigator").controller("ResultsCtrl",ResultsCtrl),ResultsCtrl.$inject=["$location","$routeParams","$http","Data"]}(),function(){"use strict";function SidenavCtrl($timeout,$mdSidenav,$location,Auth,$log,Data){var vm=this;vm.locations=[{path:"/admin",name:"Dashboard",icon:"home"},{path:"/admin/industries",name:"Industries",icon:"business"},{path:"/admin/topics",name:"Topics",icon:"chat_bubble"},{path:"/admin/countries",name:"Countries",icon:"public"},{path:"/admin/contacts",name:"Contacts",icon:"contacts"},{path:"/admin/websites",name:"Websites",icon:"web"},{path:"/admin/reports",name:"Reports",icon:"show_chart"},{path:"/admin/account",name:"Account",icon:"supervisor_account"}],vm.navigate=function(where){$location.path(where),vm.close()},vm.close=function(){$mdSidenav("sidenav").close().then(function(){$log.debug("close LEFT is done")})},vm.auth=Auth,vm.signOut=function(){vm.auth.$signOut(),Data.showToast("Signed out successfully!"),$location.path("/"),vm.close()}}angular.module("exportsNavigator").controller("SidenavCtrl",SidenavCtrl),SidenavCtrl.$inject=["$timeout","$mdSidenav","$location","Auth","$log","Data"]}(),function(){"use strict";function ToolbarCtrl($timeout,$mdSidenav,$log,Auth){function debounce(func,wait,context){var timer;return function(){var context=vm,args=Array.prototype.slice.call(arguments);$timeout.cancel(timer),timer=$timeout(function(){timer=void 0,func.apply(context,args)},wait||10)}}function buildDelayedToggler(navID){return debounce(function(){$mdSidenav(navID).toggle().then(function(){$log.debug("toggle "+navID+" is done")})},200)}var vm=this;vm.auth=Auth,vm.auth.$onAuthStateChanged(function(user){vm.user=user}),vm.toggleSidenav=buildDelayedToggler("sidenav"),vm.isOpenSidenav=function(){return $mdSidenav("sidenav").isOpen()}}angular.module("exportsNavigator").controller("ToolbarCtrl",ToolbarCtrl),ToolbarCtrl.$inject=["$timeout","$mdSidenav","$log","Auth"]}();